dim FSB_and_OC_Topology = [null,[null,[null, "太原迎泽气象宾馆宿舍48芯汇聚分纤箱",6,0],[null,"太原迎泽气象宾馆宿舍13#楼2单元楼外一层半1号一级GF0001",12,3],[null,"太原迎泽气象宾馆宿舍13#1单元楼内一层半二级GF0001",12,2],[null,"太原迎泽气象宾馆宿舍13#2单元楼内一层半二级GF0001",6,2],[null,"太原迎泽气象宾馆宿舍13#3单元楼内一层半二级GF0001",0,2]],[null,[null,"太原迎泽气象宾馆宿舍13#楼2单元楼外一层半1号一级GF0001",12,3],[null,"太原迎泽气象宾馆宿舍11#3单元楼内一层半二级GF0001",6,1],[null,"太原迎泽气象宾馆宿舍11#2单元楼内一层半二级GF0001",6,1],[null,"太原迎泽气象宾馆宿舍11#1单元楼内一层半二级GF0001",0,2],[]]]
dim k = 1
dim list_a = []


for i = 1 to 2
    for j = 1 to 5
        // TracePrint(i)
        // TracePrint(j)
        if len(FSB_and_OC_Topology[i][j]) = 0 //空箱跳过
            break
        end if
        if FSB_and_OC_Topology[i][j][3] <> null
            if FSB_and_OC_Topology[i][j][3] <> 0
                list_a[k] = clone(FSB_and_OC_Topology[i][j]) //直接利用FSB_and_OC_Topology的数据
                if j > 1
                    list_a[k] = push(list_a[k],FSB_and_OC_Topology[i][(j - 1)][2]) //上行
                    if FSB_and_OC_Topology[i][(j - 1)][3] = 0 //处理空箱,判断上一个箱子的分光器数量
                        list_a[k][4] = 0
                    end if
                elseif j = 1
                    list_a[k] = push(list_a[k],0) //第一个箱子上行为0
                end if
                k = k + 1
            end if
        end if
    next
next
TracePrint(list_a)

return retValueexit()